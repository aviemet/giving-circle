# Giving Circle Project Documentation

## Project Overview

### Model Organization

### Slide Management
- Slides are managed through a polymorphic association using `SlideParent` join table
- Templates can have multiple slides through `has_many :slides, through: :slide_parents`
- Slides can belong to multiple templates through `has_many :templates, through: :slide_parents`
- Slide ordering is handled by the `order` field in `SlideParent`
- Templates also store slide data as JSONB in the `slides` field for presentation purposes

## Project Milestones

### Phase 1: Core Authentication and Authorization

## Conventions
### Architecture

### Development Guidelines
- Changes must be atomic and focused
- TypeScript is used for all JavaScript code
  - Start with most restrictive type definitions
  - Avoid `any`, `unknown`, and type casting with `as`
  - Prefer existing type definitions and interfaces
  - Use generics, Records, and Mapped types before inline types
  - Type assertions are a last resort

### ESLint Configuration
- Using `@stylistic/eslint-plugin` for code formatting

## Feature Documentation
*Document completed features and their core functionality here*

## Technical Decisions
### Authentication & Authorization
- Using Devise for authentication
- Using Pundit for authorization policies
- Using Rolify for role management
- Authorization enforced at both API and UI levels

### Document Management
- Documents will be stored using Active Storage
- Version control will be maintained for important documents
- Access control will be managed through Pundit policies

### Frontend Components
#### UI Framework
- Using Mantine v8+
  - Always use latest component API and prop names
  - Refer to Mantine documentation for current component structure

#### Icons
- Icons are centrally exported from `@/components/Icons`
- Icons are renamed on export for semantic usage (e.g., `TbDashboard as DashboardIcon`)
- Global icon configuration via `IconProvider` with defaults:
  - className: "react-icon"
  - size: "1rem"

#### Component Organization
- Frontend code is organized in `/app/frontend/`
  - `/components`: Reusable, general-purpose components
  - `/features`: Feature-specific components
  - `/layouts`: App Layout components
  - `/lib`: Non-React code and utilities
  - `/pages`: Top-level Inertia pages (entry points for routes)
  - `/queries`: Async react-query methods
  - `/types`: Global types and interfaces

#### UI & Styling
- Mantine component library
- CSS modules with Linaria
  - Files use `.css.ts` extension
  - Imports as `import * as classes from './file.css'`
  - Class composition with `clsx`
- Dark/light theme support via Mantine theme system

#### Form Implementation
- Built on `use-inertia-form`
- Form component wraps Inertia form with Mantine UI
- Supports nested data through `NestedObject` type
- Rails-compatible form attributes by default
- Custom inputs use `useInertiaInput` hook
- Form state includes processing, errors, validation, and dirty tracking
- All components strictly typed with `BaseFormInputProps<T>` interface

#### State Management
- Server state: Inertia.js
- Client-only state: zustand
- Form state: use-inertia-form

#### Type System
- Strict TypeScript throughout
- No use of `any`, `unknown`, or type casting with `as`
- Prefer existing type definitions and interfaces
- Use generics, Records, and Mapped types before inline types
- Type assertions as last resort
- Auto-generated types for serializers

#### Internationalization (i18n)
- Using react-i18next for frontend translations
- Translation files from i18n-js gem
- Translations in Rails locales (yml)
- Full i18n support (numbers, dates, currency, RTL)
- Translation organization:
  - Model-specific translations in `config/locales/[model]/frontend.en.yml`
  - Other frontend translations in `config/locales/frontend.en.yml`
  - Frontend key structure:
    - `views.[feature].[page].[key]` (e.g., `views.clients.index.title`)
    - Common elements are shared within their feature namespace (e.g., `views.devise.shared.email`)
- Common notice templates in `en.yml` under `templates.controllers.notices`
  - Reusable patterns for CRUD operations
  - Uses `%{model}` interpolation
  - Can be extended in model-specific locale files
- Controller notice messages use standard templates:
  - Created: `t("templates.controllers.notices.created", model: "Model Name")`
  - Updated: `t("templates.controllers.notices.updated", model: "Model Name")`
  - Destroyed: `t("templates.controllers.notices.destroyed", model: "Model Name")`
  - Status Updated: `t("templates.controllers.notices.status_updated", model: "Model Name")`

#### Testing
- Unit: Vitest + React Testing Library
- E2E: Playwright (no mocks, uses test environment)
- Test files mirror source structure in `/app/frontend/tests`

#### Performance
- Component code splitting
- Route-based lazy loading
- Image optimization
- Proper useEffect cleanup
- Memoized expensive computations
- Minimal global state
